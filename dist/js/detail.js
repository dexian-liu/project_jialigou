"use strict";function _classCallCheck(n,a){if(!(n instanceof a))throw new TypeError("Cannot call a class as a function")}function _defineProperties(n,a){for(var t=0;t<a.length;t++){var i=a[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function _createClass(n,a,t){return a&&_defineProperties(n.prototype,a),t&&_defineProperties(n,t),n}var Product=function(){function n(){_classCallCheck(this,n),this.addEvent(),this.init()}return _createClass(n,[{key:"init",value:function(){var n=$.cookie("carts")?$.cookie("carts"):"",a=convertStrToObj(n),t=0;for(var i in a)t+=a[i].good_num;$(".menu-cart span").last().html(t)}},{key:"addEvent",value:function(){var i=window.location.search.replace("?id=","");$.ajax({type:"get",url:"../php/list.php",success:function(n){n=JSON.parse(n),$.each(n,function(n,a){var t;a.id==i&&(t='\n                        <div class="detail-content-logo">\n                            <img src="../img/detail-content-logo'.concat(a.id,'.jpg" alt="">\n                            <div class="mask"></div>\n                            <div class="big">\n                                <img src="../img/detail-content-logo').concat(a.id,'.jpg" alt="">\n                            </div>\n                        </div>\n                        <div class="detail-content-logo-samll">\n                            <img src="../img/detail-content-logo').concat(a.id,'.jpg" alt="">\n                        </div>\n                        <div class="detail-content-list" data-id="sp').concat(a.id,'">\n                            <h2>\n                                <span>自营商品</span> \n                                <span class="good-name">').concat(a.name,'</span>\n                                <span class="good-id">(供货号:').concat(a.serial,')</span>\n                            </h2>\n                            <ul>\n                                <li>\n                                    <span>嘉丽价</span>\n                                    <span class="good-price">').concat(a.price,'</span></li>\n                                <li>\n                                    <span>积分</span>\n                                    <span class="good-point">订购此商品可返回').concat(a.point,'积分</span>\n                                </li>\n                                <li>\n                                    <span>尺寸</span>\n                                    <span class="good-size">').concat(a.name,'\n                                    </span>\n                                </li>\n                                <li>\n                                    <span>数量</span>\n                                    <span class="good-size clear">\n                                        <a href="javascript:;" class="minus">-</a>\n                                        <input type="text" class="num" value="1">\n                                        件\n                                        <a href="javascript:;" class="plus">+</a>\n                                    </span>\n                                </li>\n                            </ul>\n                            <div class="btn clear">\n                                <a href="javascript:;" class="buy">立即购买</a>\n                                <a href="javascript:;" class="addcart">加入购物车</a>\n                                <a href="javascript:;" class="collect">收藏</a>\n                            </div>\n                        </div>\n                    </div>\n                        '),$(".detail-content").html(t),$(".addcart").on("click",function(){var n=$(this).parent().parent().children("h2").children(".good-name").html(),a=$(this).parent().parent().children("h2").children(".good-id").html(),t=/(\d+)/,a=parseInt(t.exec(a)[1]),i=parseInt($(this).parent().prev().children().last().children(".good-size").find(".num").val()),e=$(this).parent().prev().children().eq(1).children(".good-point").html(),e=parseInt(t.exec(e)[1]),s=parseInt($(this).parent().prev().children().eq(0).children(".good-price").html()),o=$(this).parent().parent().attr("data-id"),c=parseInt(t.exec(o)[1]),l=$.cookie("carts")?$.cookie("carts"):"",r=convertStrToObj(l);o in r?r[o].good_num+=i:r[o]={good_serial:a,good_name:n,good_price:s,good_num:i,good_point:e,good_img:c},$.cookie("carts",JSON.stringify(r),{expires:7,path:"/"});var d=parseInt($(".menu-cart span").last().html());d+=i,$(".menu-cart span").last().html(d)}),$(".menu-cart").on("click",function(){location.href="./cart.html"}),$(".detail-content-logo").on("mouseenter",function(){$(".mask").css("display","block"),$(".big").css("display","block"),$(this).on("mousemove",function(n){var a=parseInt(n.pageX-$(this).offset().left),t=parseInt(n.pageY-$(this).offset().top),i=a-$(".mask").width()/2,e=t-$(".mask").height()/2;i<=0?i=0:i>=$(this).width()-$(".mask").width()&&(i=$(this).width()-$(".mask").width()),e<=0?e=0:e>=$(this).height()-$(".mask").height()&&(e=$(this).height()-$(".mask").height()),$(".mask").css({left:i,top:e});var s=i/($(".detail-content-logo").width()-$(".mask").width()),o=e/($(".detail-content-logo").height()-$(".mask").height()),c=($(".big").width()-$(".big img").width())*s,l=($(".big").height()-$(".big img").height())*o;$(".big img").css({left:c,top:l})}),$(this).on("mouseleave",function(){$(".mask").css("display","none"),$(".big").css("display","none")})}),$(".minus").on("click",function(){var n=$(this).next().val();--n<=0&&(n=1),$(".num").val(n)}),$(".plus").on("click",function(){var n=$(this).prev().val();n++,$(".num").val(n)}))})}})}}]),n}();